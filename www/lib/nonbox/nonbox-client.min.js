!function(){"use strict";angular.module("nonbox-client",["ui.router"]);var t=angular.module("nonbox-client");t.run(["$rootScope",function(t){t.nbConnected=!1,t.nbServer="http://192.168.42.1:8080/",t.nbApi="https://nonbox.co/",t.$on("loading:start",function(){t.isLoading=!0}),t.$on("loading:finish",function(){t.isLoading=!1})}]),t.config(["$sceProvider","$httpProvider",function(t,e){e.defaults.headers.get||(e.defaults.headers.get={"Cache-Control":"no-cache",Pragma:"no-cache"}),t.enabled(!1),e.interceptors.push(["$q","$rootScope",function(t,e){return{request:function(n){return e.$broadcast("loading:start"),n||t.when(n)},response:function(n){return e.$broadcast("loading:finish"),n||t.when(n)},responseError:function(n){return e.$broadcast("loading:finish"),t.reject(n)}}}])}]),t.config(["$locationProvider","$stateProvider","$urlRouterProvider",function(t,e,n){e.state("device",{url:"/",templateUrl:templateDir+"/device.html",controller:"DeviceCtrl"}).state("networks",{url:"/networks",templateUrl:templateDir+"/networks.html",controller:"WifiCtrl"}).state("quickstart",{url:"/quickstart",templateUrl:templateDir+"/quickstart.html"}).state("tutorials",{url:"/tutorials",templateUrl:templateDir+"/tutorials.html",controller:["$scope","Tutorials",function(t,e){t.showMode=!1,t.tutorials=e,t.show=function(e){t.showMode=!0,t.tutorial=e}}]}).state("support",{url:"/support",templateUrl:templateDir+"/support.html"}).state("bugs",{url:"/bugs",templateUrl:templateDir+"/bugreport.html",controller:"ReportsCtrl"}).state("suggestions",{url:"/suggestions",templateUrl:templateDir+"/suggestion.html",controller:"ReportsCtrl"}).state("pr",{url:"/pr",templateUrl:templateDir+"/pr.html"}),n.otherwise("/")}]),t.controller("DeviceCtrl",["$scope","$rootScope","Nonbox","Wifi",function(t,e,n,o){t.assigned={total:10,remaining:2,devices:[{}]},t.check=function(){n.check().then(function(t){e.nbConnected=t}).catch(function(t){e.nbConnected=t}).finally(function(){o.status(),t.$broadcast("scroll.refreshComplete")})},t.check()}]),t.controller("ReportsCtrl",["$state","$scope","Report",function(t,e,n){e.message={},e.submit=function(o){n.submit(o,t.current.name).then(function(t){200==t.status?e.message={text:"Thanks! We'll take a look.",icon:"check",color:"green"}:e.message={text:"Error submitting. Check internet connection.",color:"red"}}).catch(function(t){e.message={text:"Error submitting. Check internet connection.",color:"red"}}),e.$apply}}]),t.controller("WifiCtrl",["$injector","$scope","$state","$timeout","Nonbox","Wifi",function(t,e,n,o,r,i){function s(n){var o=document.getElementById("passwordDialog");if(console.log(o),null!=o)"open"===n&&o.showModal(),"close"===n&&o.close(),console.log("here");else{if("close"===n)return;t.get("$ionicPopup").show({template:'<input type="password" ng-model="currentAp.password">',title:"Connect to "+e.currentAp.ssid,scope:e,buttons:[{text:"Cancel"},{text:"Connect",type:"button-dark",onTap:function(t){e.currentAp.password?e.secureConnect(e.currentAp):t.preventDefault()}}]})}}e.connectSecure=!1,e.currentAp={},e.networks=[],e.error="",e.status="",e.colorStrength=function(t){return"rgba(253,188,64,"+(t>80?.01*t:.01*(t-15))+")"},e.connect=function(t){e.currentAp=t,t.security?s("open"):(i.connect(t).then(function(t){}),e.scan())},e.secureConnect=function(t){s("close"),i.connect(t).then(function(t){delete e.currentAp.password,console.log(t.status),500===t.status?s("open"):e.scan()})},e.cancelConnect=function(t){s("close")},e.disconnect=function(){i.disconnect().then(function(t){e.scan()})},e.reset=function(){i.reset().then(function(t){e.scan()})},e.scan=function(){i.status().then(function(t){1==t.success?e.current=t:e.current={ssid:!1}}),i.scan().then(function(t){t.data&&1==t.data.success?e.networks=t.data.networks.filter(function(t){return"nonbox"!==t.ssid}):t.data&&(e.error=t.data.msg)}).catch(function(t){n.go("device")}).finally(function(){e.$broadcast("scroll.refreshComplete")})},e.$on("$ionicView.enter",function(){e.scan()}),e.scan()}]),t.service("Nonbox",["$rootScope","$http",function(t,e){return{check:function(){return e.get(t.nbServer).then(function(t){return 200===t.status&&"nonbox server"===t.data}).catch(function(t){return!1})},info:function(){return e.post(t.nbServer+"info").then(function(t){return t}).catch(function(t){return t})}}}]),t.service("Report",["$rootScope","$http",function(t,e){return{submit:function(n,o){return e.post(t.nbApi+"report/"+o,n).then(function(t){return t},function(t){return t}).catch(function(t){return t})}}}]),t.service("Tutorials",function(){return[{title:"Test Tutorial One",description:"Test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description",icon:"key",steps:[{order:1,text:"First you have to do this",image:""},{order:2,text:"Then you have to do that",image:""},{order:3,text:"And there you have it folks. Power on and rock the house",image:""}]},{title:"Test Tutorial Two",description:"Test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description",icon:"lamp",steps:[{order:1,text:"First you have to do this",image:""},{order:2,text:"Then you have to do that",image:""},{order:3,text:"And there you have it folks. Power on and rock the house",image:""}]},{title:"Test Tutorial Three",description:"Test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description",icon:"tools",steps:[{order:1,text:"First you have to do this",image:""},{order:2,text:"Then you have to do that",image:""},{order:3,text:"And there you have it folks. Power on and rock the house",image:""}]},{title:"Test Tutorial Four",description:"Test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description test turial one description",icon:"cog",steps:[{order:1,text:"First you have to do this",image:""},{order:2,text:"Then you have to do that",image:""},{order:3,text:"And there you have it folks. Power on and rock the house",image:"cog"}]}]}),t.service("Wifi",["$rootScope","$http",function(t,e){return{scan:function(){return e.get(t.nbServer+"scan",{timeout:5e3}).then(function(t){return t}).catch(function(t){return t})},connect:function(n){return e.post(t.nbServer+"connect",{ap:n}).then(function(t){return t}).catch(function(t){return t})},status:function(){return e.get(t.nbServer+"status",{timeout:5e3}).then(function(e){return t.online=e.data.success,e.data}).catch(function(e){return t.online=!1,e})},disconnect:function(){return e.delete(t.nbServer+"disconnect").then(function(e){return t.online=!1,e}).catch(function(t){return t})},reset:function(){return e.delete(t.nbServer+"reset",{timeout:7e3}).then(function(e){return t.online=e.data.success,e.data}).catch(function(e){return t.online=!1,e})}}}])}();